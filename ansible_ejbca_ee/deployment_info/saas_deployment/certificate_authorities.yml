---

root_add_certification_authorities:
  - caname: "{{ root_ca }}"
    certprofile: "RootCA-{{ organizationNameShort }}-G3"
    dn: "CN={{ root_ca }},{{ organizationDistinguishedName }}"
    validity: "9132"
    validity_yml: "25y"
    policy: "null"
    signalg: "SHA256withRSA"
    serial_number_octet_size: 20
    pre_produce_ocsp_responses: false
    store_responses_on_demand: false
    use_append_only_table: false
    use_utf8_in_policy_notice_text: false
    defaultCRLDP: "http://{{ root_fqdn }}/ejbca/publicweb/crls"
    skid_hash_used: true
    defaultOCSPServiceLocator: "http://{{ root_fqdn }}/ejbca/publicweb/status/ocsp"
    authorityInformationAccess: "http://aia.{{ organizationDomainName }}/ejbca/publicweb/webdist/certdist?cmd=cacert&issuer=CN%3d{{ organizationNameCRL }}+Root+CA+G1%2cOU%3dCertification+Authorities%2cO%3d{{ organizationNameCRL }}%2cC%3d{{ countryName }}&level=1"
    certificateAiaDefaultCaIssuerUri: "http://aia.{{ organizationDomainName }}/ejbca/publicweb/webdist/certdist?cmd=cacert&issuer=CN%3d{{ organizationNameCRL }}+Root+CA+G1%2cOU%3dCertification+Authorities%2cO%3d{{ organizationNameCRL }}%2cC%3d{{ countryName }}&level=1"
    crlPeriod: 15552000000
    crlPeriod_yml: 12mo
    crlIssueInterval: 0
    crlIssueInterval_yml: 6m
    crl_overlap_time: 600000
    crl_overlap_time_yml: 0m
    delta_crl_period: 0m
    useLdapDnOrder: false
    enforce_unique_public_keys: true
    enforce_key_renewal: false
    enforce_unique_dn: true
    user_storage: true
    certificate_storage: true
    accept_revocations_for_non_existing_entries: false
    finish_user: true
    ca_healthcheck_enabled: true
    request_processor: 'null'
    cryptotoken_enable_auto_activate: false
    tokentype: "{{ crypto_type }}"
    tokenpass: "{{ root_keystore_pass }}"
    slot_identifier_type: "{{ slot_identifier_type }}"
    slot_identifier_value: "{{ slot_identifier_value }}"
    force_used_slots: true
    crypto_token_name: "{{ root_crypto_token_name }}"
    crypto_token:
      - key_label: "signKey001"
        key_size: 4096
        key_type: "RSA"
        type: sign
      - key_label: "defaultKey001"
        key_size: 4096
        key_type: "RSA"
        type: default
      - key_label: "testKey001"
        key_size: 2048
        key_type: "RSA"
        type: test

sub_add_certification_authorities:
  - caname: "{{ issuing_ca_1 }}"
    certprofile: "SubCA-{{ organizationNameShort }}-G3"
    eeprofile: 'ExternalCA'
    dn: "CN={{ issuing_ca_1 }},{{ organizationDistinguishedName }}"
    rootDn: External
    root_ca_name: "{{ root_ca }}"
    validity: "3650"
    validity_yml: "15y"
    policy: "null"
    signalg: "SHA256withRSA"
    serial_number_octet_size: 20
    pre_produce_ocsp_responses: false
    store_responses_on_demand: false
    use_append_only_table: false
    use_utf8_in_policy_notice_text: false
    defaultCRLDP: "http://{{ issuing_fqdn }}/ejbca/publicweb/crls"
    skid_hash_used: true
    defaultOCSPServiceLocator: "http://{{ issuing_fqdn }}/ejbca/publicweb/status/ocsp"
    authorityInformationAccess: "http://aia.{{ organizationDomainName }}/ejbca/publicweb/webdist/certdist?cmd=cacert&issuer=CN%3d{{ organizationNameCRL }}+Issuing+CA+G1%2cOU%3dCertification+Authorities%2cO%3d{{ organizationNameCRL }}%2cC%3d{{ countryName }}&level=1"
    certificateAiaDefaultCaIssuerUri: "http://aia.{{ organizationDomainName }}/ejbca/publicweb/webdist/certdist?cmd=cacert&issuer=CN%3d{{ organizationNameCRL }}+Issuing+CA+G1%2cOU%3dCertification+Authorities%2cO%3d{{ organizationNameCRL }}%2cC%3d{{ countryName }}&level=1"
    crlPeriod: 345600000
    crlPeriod_yml: 4d
    crlIssueInterval: 86400000
    crlIssueInterval_yml: 1d
    crl_overlap_time: 600000
    crl_overlap_time_yml: 0m
    delta_crl_period: 0m
    useLdapDnOrder: false
    enforce_unique_public_keys: true
    enforce_key_renewal: true
    enforce_unique_dn: true
    user_storage: true
    certificate_storage: true
    accept_revocations_for_non_existing_entries: false
    finish_user: true
    ca_healthcheck_enabled: true
    request_processor: null
    external_caname: "{{ root_ca }}"
    external_root_cachain_local_repository: false
    external_signed_ca_cert_file_local_repository: false 
    # external_root_cachain_local_file: "{{ external_root_cachain_local_file }}"
    # external_root_cachain_url: "{{ external_root_cachain_url }}"
    external_root_cachain_file: "{{ external_root_cachain_file }}"
    external_signed_ca_cert_file_url:
    external_signed_ca_cert_file: "{{ issuing_ca_1 }}.pem"
    cryptotoken_enable_auto_activate: true
    token: USERGENERATED
    entity_pass: "{{ encrypted_entity_pass | default ('ejbca') }}"
    tokentype: "{{ crypto_type }}"
    tokenpass: "{{ issuing_keystore_pass }}"
    slot_identifier_type: "{{ slot_identifier_type }}"
    slot_identifier_value: "{{ slot_identifier_value }}"
    force_used_slots: true
    crypto_token_name: "{{ issuing_crypto_token_name }}"
    crypto_token:
      - key_label: "signKey{{ issuing_ca_1 }}001"
        key_size: 4096
        key_type: "RSA"
        type: sign
      - key_label: "defaultKey{{ issuing_ca_1 }}001"
        key_size: 4096
        key_type: "RSA"
        type: default
      - key_label: "testKey001"
        key_size: 2048
        key_type: "RSA"
        type: test

  - caname: "{{ issuing_ca_2 }}"
    certprofile: "SubCA-{{ organizationNameShort }}-G3"
    eeprofile: 'ExternalCA'
    dn: "CN={{ issuing_ca_2 }},{{ organizationDistinguishedName }}"
    rootDn: External
    root_ca_name: "{{ root_ca }}"
    validity: "3650"
    validity_yml: "15y"
    policy: "null"
    signalg: "SHA256withRSA"
    serial_number_octet_size: 20
    pre_produce_ocsp_responses: false
    store_responses_on_demand: false
    use_append_only_table: false
    use_utf8_in_policy_notice_text: false
    defaultCRLDP: "http://{{ issuing_fqdn }}/ejbca/publicweb/crls"
    skid_hash_used: true
    defaultOCSPServiceLocator: "http://{{ issuing_fqdn }}/ejbca/publicweb/status/ocsp"
    authorityInformationAccess: "http://aia.{{ organizationDomainName }}/ejbca/publicweb/webdist/certdist?cmd=cacert&issuer=CN%3d{{ organizationNameCRL }}+Issuing+CA+G1%2cOU%3dCertification+Authorities%2cO%3d{{ organizationNameCRL }}%2cC%3d{{ countryName }}&level=1"
    certificateAiaDefaultCaIssuerUri: "http://aia.{{ organizationDomainName }}/ejbca/publicweb/webdist/certdist?cmd=cacert&issuer=CN%3d{{ organizationNameCRL }}+Issuing+CA+G1%2cOU%3dCertification+Authorities%2cO%3d{{ organizationNameCRL }}%2cC%3d{{ countryName }}&level=1"
    crlPeriod: 345600000
    crlPeriod_yml: 4d
    crlIssueInterval: 86400000
    crlIssueInterval_yml: 1d
    crl_overlap_time: 600000
    crl_overlap_time_yml: 0m
    delta_crl_period: 0m
    useLdapDnOrder: false
    enforce_unique_public_keys: true
    enforce_key_renewal: true
    enforce_unique_dn: true
    user_storage: true
    certificate_storage: true
    accept_revocations_for_non_existing_entries: false
    finish_user: true
    ca_healthcheck_enabled: true
    request_processor: null
    external_caname: "{{ root_ca }}"
    external_root_cachain_local_repository: false
    external_signed_ca_cert_file_local_repository: false 
    # external_root_cachain_local_file: "{{ external_root_cachain_local_file }}"
    # external_root_cachain_url: "{{ external_root_cachain_url }}"
    external_root_cachain_file: "{{ external_root_cachain_file }}"
    external_signed_ca_cert_file_url:
    external_signed_ca_cert_file: "{{ issuing_ca_2 }}.pem"
    cryptotoken_enable_auto_activate: true
    token: USERGENERATED
    entity_pass: "{{ encrypted_entity_pass | default ('ejbca') }}"
    tokentype: "{{ crypto_type }}"
    tokenpass: "{{ issuing_keystore_pass }}"
    slot_identifier_type: "{{ slot_identifier_type }}"
    slot_identifier_value: "{{ slot_identifier_value }}"
    force_used_slots: true
    crypto_token_name: "{{ issuing_crypto_token_name }}"
    crypto_token:
      - key_label: "signKey{{ issuing_ca_2 }}001"
        key_size: 4096
        key_type: "RSA"
        type: sign
      - key_label: "defaultKey{{ issuing_ca_2 }}001"
        key_size: 4096
        key_type: "RSA"
        type: default
      - key_label: "testKey001"
        key_size: 2048
        key_type: "RSA"
        type: test

  - caname: "{{ issuing_ca_3 }}"
    certprofile: "SubCA-{{ organizationNameShort }}-G3"
    eeprofile: 'ExternalCA'
    dn: "CN={{ issuing_ca_3 }},{{ organizationDistinguishedName }}"
    rootDn: External
    root_ca_name: "{{ root_ca }}"
    validity: "3650"
    validity_yml: "15y"
    policy: "null"
    signalg: "SHA256withRSA"
    serial_number_octet_size: 20
    pre_produce_ocsp_responses: false
    store_responses_on_demand: false
    use_append_only_table: false
    use_utf8_in_policy_notice_text: false
    defaultCRLDP: "http://{{ issuing_fqdn }}/ejbca/publicweb/crls"
    skid_hash_used: true
    defaultOCSPServiceLocator: "http://{{ issuing_fqdn }}/ejbca/publicweb/status/ocsp"
    authorityInformationAccess: "http://aia.{{ organizationDomainName }}/ejbca/publicweb/webdist/certdist?cmd=cacert&issuer=CN%3d{{ organizationNameCRL }}+Issuing+CA+G1%2cOU%3dCertification+Authorities%2cO%3d{{ organizationNameCRL }}%2cC%3d{{ countryName }}&level=1"
    certificateAiaDefaultCaIssuerUri: "http://aia.{{ organizationDomainName }}/ejbca/publicweb/webdist/certdist?cmd=cacert&issuer=CN%3d{{ organizationNameCRL }}+Issuing+CA+G1%2cOU%3dCertification+Authorities%2cO%3d{{ organizationNameCRL }}%2cC%3d{{ countryName }}&level=1"
    crlPeriod: 345600000
    crlPeriod_yml: 4d
    crlIssueInterval: 86400000
    crlIssueInterval_yml: 1d
    crl_overlap_time: 600000
    crl_overlap_time_yml: 0m
    delta_crl_period: 0m
    useLdapDnOrder: false
    enforce_unique_public_keys: true
    enforce_key_renewal: true
    enforce_unique_dn: true
    user_storage: true
    certificate_storage: true
    accept_revocations_for_non_existing_entries: false
    finish_user: true
    ca_healthcheck_enabled: true
    request_processor: null
    external_caname: "{{ root_ca }}"
    external_root_cachain_local_repository: false
    external_signed_ca_cert_file_local_repository: false 
    # external_root_cachain_local_file: "{{ external_root_cachain_local_file }}"
    # external_root_cachain_url: "{{ external_root_cachain_url }}"
    external_root_cachain_file: "{{ external_root_cachain_file }}"
    external_signed_ca_cert_file_url:
    external_signed_ca_cert_file: "{{ issuing_ca_3 }}.pem"
    cryptotoken_enable_auto_activate: true
    token: USERGENERATED
    entity_pass: "{{ encrypted_entity_pass | default ('ejbca') }}"
    tokentype: "{{ crypto_type }}"
    tokenpass: "{{ issuing_keystore_pass }}"
    slot_identifier_type: "{{ slot_identifier_type }}"
    slot_identifier_value: "{{ slot_identifier_value }}"
    force_used_slots: true
    crypto_token_name: "{{ issuing_crypto_token_name }}"
    crypto_token:
      - key_label: "signKey{{ issuing_ca_3 }}001"
        key_size: 4096
        key_type: "RSA"
        type: sign
      - key_label: "defaultKey{{ issuing_ca_3 }}001"
        key_size: 4096
        key_type: "RSA"
        type: default
      - key_label: "testKey001"
        key_size: 2048
        key_type: "RSA"
        type: test

  - caname: "{{ issuing_ca_4 }}"
    certprofile: "SubCA-{{ organizationNameShort }}-G3"
    eeprofile: 'ExternalCA'
    dn: "CN={{ issuing_ca_4 }},{{ organizationDistinguishedName }}"
    rootDn: External
    root_ca_name: "{{ root_ca }}"
    validity: "3650"
    validity_yml: "15y"
    policy: "null"
    signalg: "SHA256withRSA"
    serial_number_octet_size: 20
    pre_produce_ocsp_responses: false
    store_responses_on_demand: false
    use_append_only_table: false
    use_utf8_in_policy_notice_text: false
    defaultCRLDP: "http://{{ issuing_fqdn }}/ejbca/publicweb/crls"
    skid_hash_used: true
    defaultOCSPServiceLocator: "http://{{ issuing_fqdn }}/ejbca/publicweb/status/ocsp"
    authorityInformationAccess: "http://aia.{{ organizationDomainName }}/ejbca/publicweb/webdist/certdist?cmd=cacert&issuer=CN%3d{{ organizationNameCRL }}+Issuing+CA+G1%2cOU%3dCertification+Authorities%2cO%3d{{ organizationNameCRL }}%2cC%3d{{ countryName }}&level=1"
    certificateAiaDefaultCaIssuerUri: "http://aia.{{ organizationDomainName }}/ejbca/publicweb/webdist/certdist?cmd=cacert&issuer=CN%3d{{ organizationNameCRL }}+Issuing+CA+G1%2cOU%3dCertification+Authorities%2cO%3d{{ organizationNameCRL }}%2cC%3d{{ countryName }}&level=1"
    crlPeriod: 345600000
    crlPeriod_yml: 4d
    crlIssueInterval: 86400000
    crlIssueInterval_yml: 1d
    crl_overlap_time: 600000
    crl_overlap_time_yml: 0m
    delta_crl_period: 0m
    useLdapDnOrder: false
    enforce_unique_public_keys: true
    enforce_key_renewal: true
    enforce_unique_dn: true
    user_storage: true
    certificate_storage: true
    accept_revocations_for_non_existing_entries: false
    finish_user: true
    ca_healthcheck_enabled: true
    request_processor: null
    external_caname: "{{ root_ca }}"
    external_root_cachain_local_repository: false
    external_signed_ca_cert_file_local_repository: false 
    # external_root_cachain_local_file: "{{ external_root_cachain_local_file }}"
    # external_root_cachain_url: "{{ external_root_cachain_url }}"
    external_root_cachain_file: "{{ external_root_cachain_file }}"
    external_signed_ca_cert_file_url:
    external_signed_ca_cert_file: "{{ issuing_ca_4 }}.pem"
    cryptotoken_enable_auto_activate: true
    token: USERGENERATED
    entity_pass: "{{ encrypted_entity_pass | default ('ejbca') }}"
    tokentype: "{{ crypto_type }}"
    tokenpass: "{{ issuing_keystore_pass }}"
    slot_identifier_type: "{{ slot_identifier_type }}"
    slot_identifier_value: "{{ slot_identifier_value }}"
    force_used_slots: true
    crypto_token_name: "{{ issuing_crypto_token_name }}"
    crypto_token:
      - key_label: "signKey{{ issuing_ca_4 }}001"
        key_size: 4096
        key_type: "RSA"
        type: sign
      - key_label: "defaultKey{{ issuing_ca_4 }}001"
        key_size: 4096
        key_type: "RSA"
        type: default
      - key_label: "testKey001"
        key_size: 2048
        key_type: "RSA"
        type: test